#LyX 2.2 created this file. For more info see http://www.lyx.org/
\lyxformat 508
\begin_document
\begin_header
\save_transient_properties true
\origin unavailable
\textclass amsart
\begin_preamble
\allowdisplaybreaks
\DeclareMathOperator{\E}{E}
\DeclareMathOperator{\Var}{Var}
\DeclareMathOperator{\Cov}{Cov}
\DeclareMathOperator{\dif}{d}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator{\tr}{tr}
\usepackage{algpseudocode}
\end_preamble
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
knitr
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman "default" "default"
\font_sans "default" "default"
\font_typewriter "default" "default"
\font_math "auto" "auto"
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100 100
\font_tt_scale 100 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry true
\use_package amsmath 2
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 1
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 1
\index Index
\shortcut idx
\color #008000
\end_index
\leftmargin 1in
\topmargin 1in
\rightmargin 1in
\bottommargin 1in
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Online Detection of Unusual Events in Audio via Dynamic Sparse Coding
\end_layout

\begin_layout Author
Courtney Grazzini
\begin_inset Newline newline
\end_inset

Meredith Miller
\begin_inset Newline newline
\end_inset

Sean Wilson
\end_layout

\begin_layout Section
Introduction
\end_layout

\begin_layout Subsection
Dictionary learning
\end_layout

\begin_layout Standard
We can represent a signal as a linear combination of basis elements.
 We refer to the basis elements as 
\emph on
atoms
\emph default
, and to the collection of these elements as a 
\emph on
dictionary
\emph default
.
 We do not require that the atoms be linearly independent, and we allow
 the dictionary to be 
\emph on
overcomplete
\emph default
, i.e., it may contain more basis elements than the dimension of the signal
 it is used to represent.
\end_layout

\begin_layout Standard
Predefined dictionaries are often used to represent signals.
 Let 
\begin_inset Formula $\mathcal{D}=\left\{ \mathbf{u},\mathbf{v}\right\} $
\end_inset

 for some linearly independent 
\begin_inset Formula $\mathbf{u},\mathbf{v}\in\mathbb{R}^{2}$
\end_inset

.
 Then, we can represent any signal 
\begin_inset Formula $\mathbf{x}\in\mathbb{R}^{2}$
\end_inset

 in terms of the atoms 
\begin_inset Formula $\mathbf{u}$
\end_inset

 and 
\begin_inset Formula $\mathbf{v}$
\end_inset

 of the dictionary 
\begin_inset Formula $\mathcal{D}$
\end_inset

.
 We might similarly consider the two-dimensional Haar wavelet basis on the
 space of real, 
\begin_inset Formula $2\times2$
\end_inset

 matrices, whose elements can be used to encode images.
 In place of a predefined dictionary, we may also choose to learn a dictionary
 directly from the signal of interest, a procedure that has been shown,
 e.g., by 
\begin_inset CommandInset citation
LatexCommand cite
key "Elad2006"

\end_inset

, to perform as well as or better than the predefined approach.
\end_layout

\begin_layout Standard
A signal 
\begin_inset Formula $\mathbf{x}\in\mathbb{R}^{n}$
\end_inset

 is said to have a 
\begin_inset Formula $k$
\end_inset


\emph on
-sparse representation
\emph default
 in a dictionary 
\begin_inset Formula $\mathcal{D}=\left\{ \mathbf{v}_{i}\right\} _{i\in\mathcal{I}}\subset\mathbb{R}^{n}$
\end_inset

 if there is a system of coefficients 
\begin_inset Formula $\left\{ c_{i}\right\} _{i\in\mathcal{I}}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{x}=\sum_{i\in\mathcal{I}}c_{i}\mathbf{v}_{i}$
\end_inset

 and 
\begin_inset Formula $c_{i}\neq0$
\end_inset

 for at most 
\begin_inset Formula $k$
\end_inset

 many indices 
\begin_inset Formula $i\in\mathcal{I}$
\end_inset

.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Elad2006"

\end_inset

 and others have shown sparse representions of natural signals to be very
 effective.
 Thus, our task in 
\emph on
dictionary learning
\emph default
 given some signal 
\begin_inset Formula $\mathbf{x}$
\end_inset

 is to learn a dictionary 
\begin_inset Formula $\mathcal{D}$
\end_inset

 such that 
\begin_inset Formula $\mathbf{x}$
\end_inset

 has a 
\begin_inset Formula $k$
\end_inset

-sparse representation in terms of the atoms of 
\begin_inset Formula $\mathcal{D}$
\end_inset

.
\end_layout

\begin_layout Subsection
Online learning
\end_layout

\begin_layout Standard
A dictionary is typically learned from a training set (possibly the signal
 to be reconstructed) using a constrained optimization procedure.
 Implementing this optimization as a 
\emph on
batch
\emph default
 procedure, wherein the entire training set is used, has proved effective
 [citation? see Lee et al 2007], it does not scale well to very large training
 sets, or to training sets that vary over time, e.g., streaming audio or video
 signals.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Mairal2009"

\end_inset

 propose an 
\emph on
online
\emph default
 approach to overcome these limitations, wherein the elements of the training
 set are accessed one at a time or in small batches.
\end_layout

\begin_layout Standard
When learning a dictionary for a streaming signal, our approach must also
 account for the phenomenon of 
\emph on
concept drift
\emph default
, wherein the statistical properties of the signal change unpredictably
 over time.
 If our learning method does not allow the dictionary to adapt to these
 changes, then reconstruction performance will degrade as we attempt to
 represent portions of the signal that the dictionary has not previously
 
\begin_inset Quotes eld
\end_inset

seen.
\begin_inset Quotes erd
\end_inset

 For example, if we wish to respresent the video feed of a traffic camera,
 we are likely to learn a dictionary well suited to representing various
 motor vehicles.
 If the same street is closed for a parade, our dictionary is not likely
 to perform acceptably when reconstructing a marching band.
 
\begin_inset CommandInset citation
LatexCommand cite
key "Zhao2011"

\end_inset

 have shown that online algorithms are robust to concept drift precisely
 because they permit the dictionary to adapt to new phenomena.
\end_layout

\begin_layout Subsection
Why we prefer sparsity - Sean
\end_layout

\begin_layout Section
Methodology - Courtney to start
\end_layout

\begin_layout Standard
equations, formal statement of algorithm for online dictionary learning,
 probably similar to Mairal.
\end_layout

\begin_layout Standard
This is how to add a reference (Insert > Citation):
\begin_inset CommandInset citation
LatexCommand cite
key "Mairal2009"

\end_inset


\end_layout

\begin_layout Standard
This is how to add an algorithm float.
 See LaTeX preamble for algpseudocode.
\end_layout

\begin_layout Standard
\begin_inset Float algorithm
placement h
wide false
sideways false
status open

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
begin{algorithmic}[1]
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Function{fft}{$
\backslash
mathbf{x},n$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
If{$n=1$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\backslash
Return{$
\backslash
mathbf{x}$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Else
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{x}^{\text{even}}\gets\begin{bmatrix}x_{0} & x_{2} & \cdots & x_{n-2}\end{bmatrix}^{\mathsf{T}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State $
\backslash
mathbf{v}
\backslash
gets$ 
\backslash
Call{fft}{$
\backslash
mathbf{x}^{
\backslash
text{even}},n/2$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $\mathbf{x}^{\text{odd}}\gets\begin{bmatrix}x_{1} & x_{3} & \cdots & x_{n-1}\end{bmatrix}^{\mathsf{T}}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State $
\backslash
mathbf{w}
\backslash
gets$ 
\backslash
Call{fft}{$
\backslash
mathbf{x}^{
\backslash
text{odd}},n/2$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
For{$j
\backslash
in
\backslash
left
\backslash
{0,1,
\backslash
ldots,n/2-1
\backslash
right
\backslash
}$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $y_{j}\gets v_{j}+\mathrm{e}^{-2\pi\iota\cdot j/n}\cdot w_{j}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
State
\end_layout

\end_inset

 
\begin_inset Formula $y_{j+n/2}\gets v_{j}-\mathrm{e}^{-2\pi\iota\cdot j/n}\cdot w_{j}$
\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFor
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
Return{$
\backslash
mathbf{y}$}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndIf
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
EndFunction
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset ERT
status open

\begin_layout Plain Layout


\backslash
end{algorithmic}
\end_layout

\end_inset


\end_layout

\begin_layout Plain Layout
\begin_inset Caption Standard

\begin_layout Plain Layout
Fast Fourier Transform
\end_layout

\end_inset


\end_layout

\end_inset


\end_layout

\begin_layout Subsection
Definition of unusual event / change point detection / whatever
\end_layout

\begin_layout Standard
algorithm for unusual event detection, probably similar to 
\begin_inset CommandInset citation
LatexCommand cite
key "Zhao2011"

\end_inset


\end_layout

\begin_layout Section
Application - TBD after code done
\end_layout

\begin_layout Subsection
Structure of an audio signal
\end_layout

\begin_layout Standard
why might we want to do online learning for an audio signal (consider a
 stream, or a huge data set, or whatever), but biggest idea is that online
 learning allows us to detect unusual events (if we learn on the whole data
 set, then possibly our dictionary will learn the unusual events, impeding
 our ability to identify them)
\end_layout

\begin_layout Subsection
What kind of dictionary could we learn for an audio signal
\end_layout

\begin_layout Standard
maybe insert image of different waveforms, e.g., as in 
\begin_inset CommandInset href
LatexCommand href
name "http://www.seaandsailor.com/dictlearning.html"
target "http://www.seaandsailor.com/dictlearning.html"

\end_inset


\end_layout

\begin_layout Subsection
Unusual event as applied to an audio signal
\end_layout

\begin_layout Standard
Change in meter, key change, whatever
\end_layout

\begin_layout Subsection
Test case - Meredith/Sean
\end_layout

\begin_layout Standard
\begin_inset Quotes eld
\end_inset

Bohemian Rhapsody
\begin_inset Quotes erd
\end_inset

 WAV or whatever, walk through the code, include graphics, especially SSE/MSE
 whatever reconstruction, and map peaks in error to 
\begin_inset Quotes eld
\end_inset

events
\begin_inset Quotes erd
\end_inset

 (hopefully, unusual) in song
\end_layout

\begin_layout Standard
This is how to add a Python 3 code chunk.
 knitr does not support Python plotting out of the box, but fortunately
 the knitron package makes it possible:
\end_layout

\begin_layout Standard
\begin_inset CommandInset href
LatexCommand href
target "https://github.com/fhirschmann/knitron"

\end_inset


\end_layout

\begin_layout Standard
Follow the instructions there to set it up, then load the package in hidden
 chunk.
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<setup, echo = F>>=
\end_layout

\begin_layout Plain Layout

library(knitron)
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
We are now ready to run some Python code.
 Notice chunk option engine = 'ipython'.
 You'll need to install scipy, matplotlib, and numpy, which can be done
 with pip3 install scipy, matplotlib (numpy is a scipy dependency).
\end_layout

\begin_layout Standard
\begin_inset ERT
status open

\begin_layout Plain Layout

<<example, engine = 'ipython', fig.height = 3, fig.width = 5, fig.align = 'center',
 fig.pos = 'h', fig.cap = 'figure caption'>>=
\end_layout

\begin_layout Plain Layout

# knitron already imports matplotlib for us
\end_layout

\begin_layout Plain Layout

# import matplotlib.pyplot as plt
\end_layout

\begin_layout Plain Layout

import scipy as sc
\end_layout

\begin_layout Plain Layout

import numpy as np
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# Load signal used to build the dictionary
\end_layout

\begin_layout Plain Layout

from scipy.io import wavfile
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

import os
\end_layout

\begin_layout Plain Layout

# fs, data = wavfile.read("03 Shot In The Back Of The Head.wav")
\end_layout

\begin_layout Plain Layout

# data = data / 2.0**15
\end_layout

\begin_layout Plain Layout

# print(data.shape)
\end_layout

\begin_layout Plain Layout

\end_layout

\begin_layout Plain Layout

# plt.rcParams.update({'font.size': 10})
\end_layout

\begin_layout Plain Layout

         
\end_layout

\begin_layout Plain Layout

# plt.plot(data[0:fs*5]) 
\end_layout

\begin_layout Plain Layout

@
\end_layout

\begin_layout Plain Layout

\end_layout

\end_inset


\end_layout

\begin_layout Standard
Include table of unusual events (key change, meter change, new instrument
 comes in)
\end_layout

\begin_layout Section
Discussion - TBD
\end_layout

\begin_layout Standard
how did the algorithm perform, how could it be extended
\end_layout

\begin_layout Standard
\begin_inset CommandInset bibtex
LatexCommand bibtex
bibfiles "library"
options "apalike"

\end_inset


\end_layout

\end_body
\end_document
